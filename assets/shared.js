
const DEMO={
  projects:[{id:1,name:'برنامج تمكين الجمعيات',owner:'NCNP',start:'2026-01-01',end:'2026-12-31',progress:55,budget:4000000,spent:2100000,status:'جارٍ',region:'الرياض'}],
  facilities:[{id:11,provider:'ASDA',name:'مركز المؤتمرات الإقليمي',city:'أبها',capacity:1200,status:'متاح'}],
  trainers:[{id:21,name:'د. سارة',topic:'تحليل البيانات',mode:'عن بعد',rating:4.8},{id:22,name:'م. سالم',topic:'ريادة الأعمال',mode:'حضوري',rating:4.6}],
  speakers:[{id:31,name:'م. أحمد',topic:'الأمن السيبراني',org:'شركة تقنية',status:'بانتظار التحقق'},{id:32,name:'د. مها',topic:'ذكاء اصطناعي',org:'جامعة',status:'متحقق'}],
  solutions:[
    {code:'S-01',title:'بوابة الرعايات الوطنية',for:'حكومي/إمارات/مانح',desc:'طرح فرص الرعاية وتتبع الأثر ونشر تقارير اتصال.'},
    {code:'S-02',title:'مسرّعات/حاضنات متكاملة',for:'Monsha’at/جامعات',desc:'إدارة دفعات، مرشدين، مؤشرات نمو وربط التمويل.'},
    {code:'S-03',title:'سوق المرافق والفعاليات',for:'جامعات/خاص/جمعيات',desc:'كتالوج مرافق، جداول، موافقات ومسح المتحدثين.'}
  ]
};
const $=(s,r=document)=>r.querySelector(s), $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
function mkTabs(root,tabs){const nav=document.createElement('div');nav.className='tabs';const area=document.createElement('div');const panels={};let i=0;for(const [label,html] of Object.entries(tabs)){const b=document.createElement('button');b.className='tab';b.textContent=label;b.addEventListener('click',()=>{nav.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));b.classList.add('active');for(const k in panels){panels[k].style.display=(k===label)?'block':'none';}});if(i===0)b.classList.add('active');nav.appendChild(b);const p=document.createElement('div');p.style.display=(i===0)?'block':'none';p.innerHTML=html;panels[label]=p;area.appendChild(p);i++;}root.appendChild(nav);root.appendChild(area);enhanceTables(root);}
function enhanceTables(root){root.querySelectorAll('table.interactive').forEach(t=>{const bar=document.createElement('div');bar.className='flex items-center gap-2 my-2';const s=document.createElement('input');s.placeholder='ابحث...';s.className='search';bar.appendChild(s);const exportBtn=document.createElement('button');exportBtn.className='btn';exportBtn.textContent='تصدير CSV';bar.appendChild(exportBtn);t.parentElement.insertBefore(bar,t);s.addEventListener('input',()=>{const q=s.value.toLowerCase();t.querySelectorAll('tbody tr').forEach(tr=>{tr.style.display=tr.innerText.toLowerCase().includes(q)?'':'none';});});exportBtn.addEventListener('click',()=>{let csv='';t.querySelectorAll('tr').forEach(tr=>{const cells=[...tr.children].map(td=>`"${td.innerText.replace(/"/g,'""')}"`);csv+=cells.join(',')+'\\n';});const blob=new Blob([csv],{type:'text/csv'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='table.csv';a.click();});});}
function tableOf(arr, cols){const head='<thead><tr>'+cols.map(c=>`<th>${c[1]}</th>`).join('')+'</tr></thead>';const body='<tbody>'+arr.map(o=>'<tr>'+cols.map(c=>`<td>${o[c[0]]??''}</td>`).join('')+'</tr>').join('')+'</tbody>';return `<table class="interactive">${head}${body}</table>`;}
function panelProjects(){const cols=[['name','المشروع'],['owner','الجهة'],['start','بداية'],['end','نهاية'],['status','الحالة']];return `<div class="card"><div class="section-title">المشاريع والمحفظة</div><div class="overflow-auto">${tableOf(DEMO.projects,cols)}</div><div class="mt-2"><button class="btn btn-primary" onclick="openModal('modalProject')">إنشاء مشروع</button></div></div>`;}
function panelFacilities(){const cols=[['name','المرفق'],['provider','المزوّد'],['city','المدينة'],['capacity','السعة'],['status','الحالة']];return `<div class="card"><div class="section-title">المرافق والفعاليات</div><div class="overflow-auto">${tableOf(DEMO.facilities,cols)}</div><div class="mt-2"><button class="btn btn-primary" onclick="openModal('modalFacility')">طلب حجز</button></div></div>`;}
function panelTrainers(){const cols=[['name','الاسم'],['topic','المجال'],['mode','النمط'],['rating','التقييم']];return `<div class="card"><div class="section-title">المدربون/المتحدثون</div><div class="overflow-auto">${tableOf(DEMO.trainers,cols)}</div><div class="mt-2"><button class="btn">التقديم كمتحدث/مدرب</button></div></div>`;}
function panelSpeakersVetting(){const cols=[['name','الاسم'],['topic','التخصص'],['org','الجهة'],['status','الحالة']];return `<div class="card"><div class="section-title">المسح الأمني للمتحدثين</div><div class="notice text-sm">هذه الواجهة مخصصة للإمارة والجهات الحكومية لاعتماد متحدثي الفعاليات.</div><div class="overflow-auto">${tableOf(DEMO.speakers,cols)}</div></div>`;}
function panelSolutions(){return `<div class="card"><div class="section-title">سوق الحلول</div><div class="grid3">${DEMO.solutions.map(s=>`<article class="card"><div class="flex items-center justify-between"><b>${s.title}</b><span class="badge">${s.for}</span></div><p class="text-sm text-slate-600 mt-1">${s.desc}</p><div class="mt-2"><button class="btn btn-accent" onclick="openModal('modalSolution')">طلب الحل</button></div></article>`).join('')}</div></div>`;}
function panelWallet(title){return `<div class="card"><div class="section-title">${title}</div><div class="grid4"><div class="kpi"><div class="text-sm text-slate-600">إجمالي الحافظة</div><div class="text-2xl font-extrabold">6.4M</div></div><div class="kpi"><div class="text-sm text-slate-600">مصروف</div><div class="text-2xl font-extrabold">4.1M</div></div><div class="kpi"><div class="text-sm text-slate-600">مشاريع مموّلة</div><div class="text-2xl font-extrabold">27</div></div><div class="kpi"><div class="text-sm text-slate-600">انحراف الميزانية</div><div class="text-2xl font-extrabold">+4%</div></div></div></div>`;}
function panelConsult(){return `<div class="card"><div class="section-title">الاستشارات</div><div class="form-grid"><input class="search" placeholder="موضوع الاستشارة"><select class="search"><option>حوكمة</option><option>أثر اجتماعي</option><option>تقني</option></select><input class="search" placeholder="الميزانية التقريبية (اختياري)"><input class="search" placeholder="الجهة/القسم"></div><div class="mt-2"><button class="btn btn-primary" onclick="openModal('modalConsult')">طلب استشارة</button></div></div>`;}
function panelJobs(){return `<div class="card"><div class="section-title">الوظائف/التدريب/التطوع</div><div class="grid3"><button class="btn btn-accent">نشر فرصة</button><button class="btn">استيراد من ملف</button><button class="btn">تصدير CSV</button></div></div>`;}
function panelPrince(){return `<div class="card"><div class="section-title">طلب رعاية الأمير</div><div class="text-sm text-slate-600 mb-2">للقطاع الحكومي/الإمارة/المانحين والقطاع الخاص (CSR).</div><button class="btn btn-primary" onclick="openModal('modalPrince')">فتح النموذج</button></div>`;}
function buildAccountPage(route,title,tabs){const main=document.querySelector('main');const header=document.createElement('div');header.className='topbar';header.innerHTML=`<div class="flex items-center justify-between"><div class="font-bold">${title}</div><a class="btn" href="../index.html">الرئيسية</a></div>`;main.prepend(header);const layout=document.createElement('div');layout.className='layout';const content=document.createElement('section');content.id='content';content.className='space-y-3';const sidebar=document.createElement('aside');sidebar.className='sidebar';sidebar.innerHTML=`<div class="section-title">الحسابات</div><nav class="space-y-1"><a class="sidebar-item" href="../accounts/gov.html">الحكومة</a><a class="sidebar-item" href="../accounts/emirate.html">الإمارة</a><a class="sidebar-item" href="../accounts/private.html">القطاع الخاص</a><a class="sidebar-item" href="../accounts/nonprofit.html">غير الربحي</a><a class="sidebar-item" href="../accounts/university.html">الجامعات</a><a class="sidebar-item" href="../accounts/individual.html">الأفراد</a><a class="sidebar-item" href="../accounts/donor.html">المانحون</a><a class="sidebar-item" href="../accounts/partners.html">الشركاء الاستراتيجيون</a></nav><div class="mt-3"><a class="btn" href="../index.html">الرجوع</a></div>`;layout.appendChild(content);layout.appendChild(sidebar);main.appendChild(layout);const host=document.createElement('div');host.className='card';host.innerHTML=`<div class="section-title">خدمات الحساب</div><div id="tabs"></div>`;content.appendChild(host);mkTabs(host.querySelector('#tabs'),tabs);injectModals(main);}
function injectModals(root){root.insertAdjacentHTML('beforeend', `
<div id="modalPrince" class="modal"><div class="box"><div class="section-title">نموذج طلب رعاية</div>
<div class="form-grid"><input class="search" placeholder="اسم المبادرة/المشروع"><input class="search" placeholder="الجهة المنفذة"><input class="search" placeholder="تاريخ البدء"><input class="search" placeholder="الميزانية التقديرية"><select class="search"><option>رعاية إعلامية</option><option>رعاية مالية</option><option>رعاية عينية</option></select><input class="search" placeholder="المنطقة/المدينة"></div>
<div class="mt-2"><button class="btn">إرفاق مستندات</button></div><div class="mt-3 flex justify-end gap-2"><button class="btn" onclick="closeModal('modalPrince')">إلغاء</button><button class="btn btn-primary" onclick="closeModal('modalPrince')">إرسال</button></div></div></div>
<div id="modalConsult" class="modal"><div class="box"><div class="section-title">طلب استشارة</div><div class="form-grid"><input class="search" placeholder="العنوان"><select class="search"><option>حوكمة</option><option>أثر اجتماعي</option><option>تقني</option></select><input class="search" placeholder="الميزانية"><input class="search" placeholder="القسم/الجهة"><textarea class="search" rows="4" placeholder="وصف مختصر"></textarea></div><div class="mt-3 flex justify-end gap-2"><button class="btn" onclick="closeModal('modalConsult')">إلغاء</button><button class="btn btn-primary" onclick="closeModal('modalConsult')">إرسال</button></div></div></div>
<div id="modalProject" class="modal"><div class="box"><div class="section-title">إنشاء مشروع</div><div class="form-grid"><input class="search" placeholder="اسم المشروع"><input class="search" placeholder="الجهة المالكة"><input type="date" class="search"><input type="date" class="search"><input class="search" placeholder="الميزانية"><select class="search"><option>حكومي</option><option>خاص</option><option>غير ربحي</option></select></div><div class="mt-3 flex justify-end gap-2"><button class="btn" onclick="closeModal('modalProject')">إلغاء</button><button class="btn btn-primary" onclick="closeModal('modalProject')">حفظ</button></div></div></div>
<div id="modalFacility" class="modal"><div class="box"><div class="section-title">طلب حجز مرفق</div><div class="form-grid"><input class="search" placeholder="اسم الفعالية"><input class="search" placeholder="المرفق"><input type="date" class="search"><input type="date" class="search"><input class="search" placeholder="السعة المتوقعة"><select class="search"><option>حضوري</option><option>عن بعد</option><option>هجيني</option></select></div><div class="mt-3 flex justify-end gap-2"><button class="btn" onclick="closeModal('modalFacility')">إلغاء</button><button class="btn btn-primary" onclick="closeModal('modalFacility')">إرسال</button></div></div></div>
<div id="modalSolution" class="modal"><div class="box"><div class="section-title">طلب حل</div><div class="form-grid"><input class="search" placeholder="اسم الحل/المنتج"><input class="search" placeholder="المزوّد (شركة/جامعة)"><input class="search" placeholder="الميزانية"><input class="search" placeholder="الإطار الزمني"><textarea class="search" rows="4" placeholder="نطاق العمل (SOW)"></textarea></div><div class="mt-3 flex justify-end gap-2"><button class="btn" onclick="closeModal('modalSolution')">إلغاء</button><button class="btn btn-primary" onclick="closeModal('modalSolution')">إرسال</button></div></div></div>
`);}
function openModal(id){$('#'+id).style.display='flex'};function closeModal(id){$('#'+id).style.display='none'};
window.Hasseef={mkTabs,tableOf,panelProjects,panelFacilities,panelTrainers,panelSpeakersVetting,panelSolutions,panelWallet,panelConsult,panelJobs,panelPrince,buildAccountPage};
